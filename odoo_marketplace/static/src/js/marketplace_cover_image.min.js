odoo.define("odoo_marketplace.update_kanban",function(e){"use strict";var t=e("web.core"),a=(e("web.data"),e("web.Dialog")),i=e("web.Model"),d=(e("web.session"),e("web_kanban.KanbanView"),e("web_kanban.Record")),r=t.qweb,o=t._t;d.include({on_kanban_action_clicked:function(e){var t=this;"res.partner"===this.model&&"set_cover"===$(e.currentTarget).data("type")?(e.preventDefault(),new i("ir.attachment").query(["id","name"]).filter([["res_model","=","res.partner"],["res_id","=",this.id],["mimetype","ilike","image"]]).all().then(function(e){var i=t.record.displayed_image_id.raw_value[0],d=$(r.render("odoo_marketplace.SetCoverModal",{cover_id:i,attachment_ids:e})),n=d.find("img"),c=new a(t,{title:o("Set a Cover Image"),buttons:[{text:o("Select"),classes:"btn-primary",close:!0,disabled:!i,click:function(){t.update_record({data:{displayed_image_id:n.filter(".o_selected").data("id")}})}},{text:o("Remove Cover Image"),close:!0,click:function(){t.update_record({data:{displayed_image_id:0}})}},{text:o("Discard"),close:!0}],$content:d}).open(),l=c.$footer.find(".btn-primary");d.on("click","img",function(e){n.not(e.currentTarget).removeClass("o_selected"),l.prop("disabled",!$(e.currentTarget).toggleClass("o_selected").hasClass("o_selected"))}),d.on("dblclick","img",function(e){t.update_record({data:{displayed_image_id:$(e.currentTarget).data("id")}}),c.close()})})):this._super.apply(this,arguments,e)}})});